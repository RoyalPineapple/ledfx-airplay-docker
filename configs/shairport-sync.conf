// Shairport Sync configuration for Airglow (AirPlay âžœ LedFX PulseAudio bridge)
// Fixed-volume AirPlay endpoint feeding LedFX's Pulse sink via shared socket
// Uses soxr interpolation for high-quality resampling
//
// For advanced configuration options, see:
// https://github.com/mikebrady/shairport-sync/blob/master/scripts/shairport-sync.conf

general =
{
	// AirPlay device name (appears in iOS/macOS AirPlay menu)
	name = "Airglow";
	
	// Enable verbose logging (1 = normal, 2 = more verbose, 3 = very verbose)
	verbose = 1;
	
	// Output backend: PulseAudio (pa)
	output_backend = "pa";
	
	// High-quality audio interpolation
	interpolation = "soxr";
	
	// Ignore volume control from AirPlay source (fixed volume output)
	// This ensures consistent audio levels for LED visualization
	ignore_volume_control = "yes";
	
	// Explicitly set mDNS backend to Avahi (required when using external Avahi container)
	mdns_backend = "avahi";
};

pa =
{
	// PulseAudio server socket (shared with LedFX container)
	server = "unix:/pulse/pulseaudio.socket";
	
	// PulseAudio authentication cookie
	cookie = "/pulse/cookie";
};

sessioncontrol =
{
	// Play hooks - Log when playback begins/ends
	run_this_before_play_begins = "/scripts/ledfx-session-hook.sh log play_begins";
	run_this_after_play_ends = "/scripts/ledfx-session-hook.sh log play_ends";
	
	// Active state hooks - ENABLED FOR TESTING
	// "Active" state persists through brief pauses between tracks
	run_this_before_entering_active_state = "/scripts/ledfx-session-hook.sh start active_state";
	run_this_after_exiting_active_state = "/scripts/ledfx-session-hook.sh stop exit_active";
	active_state_timeout = 10.0; // Stay active for 10 seconds after playback stops
	
	// Wait for hook to complete before continuing
	wait_for_completion = "yes";

	// Session timeout - wait this long after source disappears before terminating
	session_timeout = 120;
};

diagnostics =
{
	// Enable statistics logging
	statistics = "yes";
	
	// Log verbosity level (3 = very verbose, to debug hook execution)
	log_verbosity = 3;
};

